# G3 动画曲线集成可行性报告

## 1. 项目现状分析

### 1.1 技术栈
| 技术 | 版本 | 说明 |
|------|------|------|
| React | 18.2.0 | 前端框架 |
| TypeScript | 5.2.2 | 类型系统 |
| Vite | 5.0.8 | 构建工具 |
| Tailwind CSS | 3.3.6 | CSS 框架 |

### 1.2 现有动画实现
项目当前动画实现较为基础：

**CSS Keyframes 动画**：
- `fadeIn` - 渐入动画 (300ms, ease-out)
- `slideUp` - 上滑动画 (400ms, ease-out)
- `pulse-ring` - 脉冲环动画

**Tailwind 过渡效果**：
- 大量使用 `transition-all duration-200/300/500`
- 缓动函数统一为 `ease-out`
- 交互反馈：`hover:scale-105 active:scale-95`

**动画库**：
- 无专业动画库（未安装 Framer Motion、React Spring、GSAP 等）

### 1.3 需要升级的动画场景
根据代码分析，以下场景适合应用 G3 曲线：

| 场景 | 当前实现 | 优先级 |
|------|----------|--------|
| 页面过渡 | CSS transition (ease-out) | 高 |
| 模态框弹出 | animate-slide-up | 高 |
| 卡片展开 | animate-fade-in | 中 |
| 进度条动画 | transition-all duration-500 | 中 |
| 按钮交互 | hover:scale-105 | 低 |
| 下拉菜单 | animate-fade-in | 低 |

---

## 2. 可行性评估

### 2.1 方案一：CSS `linear()` 函数

**实现方式**：在 `:root` 或 `tailwind.config.js` 中定义 G3 曲线变量

```css
:root {
  --ease-g3-smooth: linear(
    0, 0.006, 0.025 2.8%, 0.101 6.1%, 0.284 12.2%, 
    0.49 18.1%, 0.675 24.3%, 0.824 31.1%, 0.926 39.4%, 
    0.98 50%, 0.996 61.3%, 1
  );
  --ease-g3-enter: linear(
    0, 0.008, 0.031 3.2%, 0.121 7.1%, 0.346 14.4%,
    0.586 21.8%, 0.766 30.1%, 0.886 40.2%,
    0.952 52.3%, 0.984 66.5%, 0.996 82.1%, 1
  );
  --ease-g3-exit: linear(
    0, 0.004 17.9%, 0.016 33.5%, 0.048 47.7%,
    0.114 59.8%, 0.234 69.9%, 0.414 78.2%,
    0.654 85.6%, 0.879 92.9%, 0.969 96.8%, 0.992, 1
  );
}
```

**可行性评估**：

| 维度 | 评分 | 说明 |
|------|------|------|
| 技术难度 | ★☆☆☆☆ | 仅需修改 CSS 变量，无需额外依赖 |
| 性能影响 | ★★★★★ | 运行在合成线程，零 JS 开销 |
| 兼容性 | ★★★☆☆ | Chrome 113+, Firefox 112+, Safari 17.2+ |
| 改动范围 | ★★☆☆☆ | 需替换现有 ease-out 为 G3 变量 |
| 维护成本 | ★★★★★ | 纯 CSS，无额外维护负担 |

**浏览器兼容性处理**：
```css
.element {
  /* 回退方案 */
  transition-timing-function: cubic-bezier(0.2, 0, 0, 1);
  /* 现代浏览器 */
  transition-timing-function: var(--ease-g3-smooth);
}
```

---

### 2.2 方案二：Framer Motion 弹簧物理

**实现方式**：安装并集成 Framer Motion

```bash
npm install framer-motion
```

```tsx
import { motion } from "framer-motion";

const Modal = () => (
  <motion.div
    initial={{ opacity: 0, y: 20 }}
    animate={{ opacity: 1, y: 0 }}
    exit={{ opacity: 0, y: -10 }}
    transition={{ type: "spring", stiffness: 300, damping: 30 }}
  >
    {/* 内容 */}
  </motion.div>
);
```

**可行性评估**：

| 维度 | 评分 | 说明 |
|------|------|------|
| 技术难度 | ★★★☆☆ | 需学习 Framer Motion API |
| 性能影响 | ★★★★☆ | 主线程 JS 计算，但高度优化 |
| 兼容性 | ★★★★★ | 支持所有主流浏览器 |
| 改动范围 | ★★★★☆ | 需重构组件，引入 motion 组件 |
| 维护成本 | ★★★☆☆ | 增加一个核心依赖 |

**包体积影响**：
- framer-motion: ~50KB (gzip 后约 17KB)
- 项目当前无动画库，属于新增依赖

---

### 2.3 方案三：混合方案（推荐）

结合方案一和方案二的优势：

| 动画类型 | 推荐方案 | 原因 |
|----------|----------|------|
| 页面过渡 | CSS linear() | 高性能，无 JS 依赖 |
| 进度条、颜色变化 | CSS linear() | 简单过渡，CSS 足够 |
| 模态框/抽屉 | Framer Motion | 需要手势支持和中断能力 |
| 拖拽交互 | Framer Motion | 实时响应用户手势 |
| 列表动画 | Framer Motion | 需要编排复杂动画序列 |
| 按钮微交互 | CSS transition | 高频操作，保持轻量 |

---

## 3. 实施建议

### 3.1 第一阶段：CSS G3 曲线（1-2天）

**改动文件**：
1. `src/index.css` - 添加 G3 曲线 CSS 变量
2. `tailwind.config.js` - 扩展 Tailwind 动画配置

**具体步骤**：
1. 在 `:root` 中定义 `--ease-g3-*` 变量
2. 替换高优先级场景的 `ease-out` 为 G3 曲线
3. 调整动画时长（G3 曲线推荐 400-600ms）
4. 添加浏览器兼容性回退

**影响组件**：
- `WordCard.tsx` - 单词卡片动画
- `StatusModal.tsx` - 状态模态框
- `SuggestionModal.tsx` - 建议模态框
- `BadgeCelebration.tsx` - 徽章庆祝动画
- `Navigation.tsx` - 导航下拉菜单

### 3.2 第二阶段：Framer Motion 集成（3-5天，可选）

**前置条件**：仅在需要复杂交互动画时执行

**步骤**：
1. 安装 framer-motion 依赖
2. 创建 `src/components/motion/` 目录，封装通用动画组件
3. 重构模态框组件，支持手势关闭
4. 添加页面级路由过渡动画

---

## 4. 风险评估

### 4.1 技术风险

| 风险 | 概率 | 影响 | 缓解措施 |
|------|------|------|----------|
| `linear()` 兼容性 | 中 | 低 | 提供 cubic-bezier 回退 |
| 动画时长调整 | 低 | 中 | 真机测试，迭代微调 |
| Framer Motion 学习曲线 | 中 | 低 | 渐进式采用，先简单场景 |
| 性能回退 | 低 | 中 | 监控 FPS，限制动画复杂度 |

### 4.2 兼容性矩阵

| 浏览器 | CSS linear() | Framer Motion |
|--------|--------------|---------------|
| Chrome 113+ | ✅ | ✅ |
| Firefox 112+ | ✅ | ✅ |
| Safari 17.2+ | ✅ | ✅ |
| Edge 113+ | ✅ | ✅ |
| 旧版浏览器 | ⚠️ 回退 | ✅ |

---

## 5. 结论

### 5.1 可行性结论

**G3 动画曲线在本项目中完全可行**，推荐采用混合方案：

1. **即时可行**：使用 CSS `linear()` 函数实现 G3 曲线，改动量小、性能最优
2. **渐进增强**：按需引入 Framer Motion 处理复杂交互场景

### 5.2 预期收益

- 动画流畅度显著提升，接近 HyperOS/iOS 级别手感
- 用户体验升级，传达高品质软件质感
- 为后续交互动画扩展奠定基础

### 5.3 投入产出比

| 方案 | 预计工时 | 收益 | ROI |
|------|----------|------|-----|
| CSS linear() | 1-2天 | 覆盖 80% 场景 | ★★★★★ |
| +Framer Motion | +3-5天 | 覆盖剩余 20% 复杂场景 | ★★★☆☆ |

**建议优先实施第一阶段（CSS linear()），快速验证效果后再决定是否推进第二阶段。**

---

## 6. 附录

### 6.1 G3 曲线参数参考

```css
/* 标准 G3 (通用场景) */
--ease-g3-standard: linear(
  0, 0.006, 0.025 2.8%, 0.101 6.1%, 0.284 12.2%, 
  0.49 18.1%, 0.675 24.3%, 0.824 31.1%, 0.926 39.4%, 
  0.98 50%, 0.996 61.3%, 1
);

/* G3 进场 (元素出现) */
--ease-g3-enter: linear(
  0, 0.008, 0.031 3.2%, 0.121 7.1%, 0.346 14.4%,
  0.586 21.8%, 0.766 30.1%, 0.886 40.2%,
  0.952 52.3%, 0.984 66.5%, 0.996 82.1%, 1
);

/* G3 离场 (元素消失) */
--ease-g3-exit: linear(
  0, 0.004 17.9%, 0.016 33.5%, 0.048 47.7%,
  0.114 59.8%, 0.234 69.9%, 0.414 78.2%,
  0.654 85.6%, 0.879 92.9%, 0.969 96.8%, 0.992, 1
);
```

### 6.2 Framer Motion 弹簧配置参考

```tsx
// 自然过渡
{ type: "spring", stiffness: 300, damping: 30 }

// 弹性回弹
{ type: "spring", stiffness: 200, damping: 15 }

// 快速响应
{ type: "spring", stiffness: 500, damping: 40 }
```
